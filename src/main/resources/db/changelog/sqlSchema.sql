--liquibase formatted sql
--changeset TestUsers_sql:1

CREATE SEQUENCE ENTITY_SEQ1 START WITH 1;

CREATE TABLE CLIENTS (
    ID NUMBER(19)  DEFAULT ENTITY_SEQ1.nextval NOT NULL,
    TYPES VARCHAR2(255),
	FULL_NAME VARCHAR2(255) NOT NULL,
    ADDRESS VARCHAR2(255),
    PHONE VARCHAR2(12) UNIQUE,
    EMAIL VARCHAR2(255) NOT NULL,
    BIRTHDAY DATE,
    PRIMARY KEY (ID)
);

--changeset TestUsers_sql:2

CREATE TABLE ACCOUNTS (
  ACCOUNT_NUMBER NUMBER(19) GENERATED BY DEFAULT AS IDENTITY,
  OWNER NUMBER(19) NOT NULL,
  ACCOUNT NUMBER(19) NOT NULL,
  DATE_OPEN DATE NOT NULL,
  VALIDITY_PERIOD DATE,
  AMOUNT NUMBER(38) NOT NULL,
  FOREIGN KEY (OWNER) REFERENCES CLIENTS(ID),
  PRIMARY KEY (ACCOUNT_NUMBER)
);

--changeset TestUsers_sql:3

CREATE TABLE BALANCES (
    ID NUMBER(19) GENERATED ALWAYS AS IDENTITY(START with 1 INCREMENT by 1),
    ACCOUNT_ID NUMBER,
    BALANCE NUMBER,
	CURRENCY_CODE VARCHAR2(3) NOT NULL,
    FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNTS(ACCOUNT_NUMBER),
    PRIMARY KEY (ID)
);

--changeset TestUsers_sql:4

CREATE TABLE PAYMENT_REQUEST (
  ID NUMBER(19) GENERATED BY DEFAULT AS IDENTITY,
  CLIENT_ID NUMBER(19) NOT NULL,
  ACCOUNT_FROM_ID NUMBER(19) NOT NULL,
  ACCOUNT_TO_ID NUMBER(19) NOT NULL,
  BILLING_AMOUNT NUMBER(38) NOT NULL,
  REQUEST_DATE DATE NOT NULL,
  PAYMENT_TEMPLATE_ID NUMBER(19) NOT NULL,
  FOREIGN KEY (CLIENT_ID) REFERENCES CLIENTS (ID),
  FOREIGN KEY (ACCOUNT_FROM_ID) REFERENCES ACCOUNTS (ACCOUNT_NUMBER),
  FOREIGN KEY (ACCOUNT_TO_ID) REFERENCES ACCOUNTS (ACCOUNT_NUMBER),
  PRIMARY KEY (ID)
);

--changeset TestUsers_sql:5

 CREATE TABLE PAYMENT_TEMPLATE (
  ID NUMBER(19) GENERATED BY DEFAULT AS IDENTITY,
  CLIENT_ID NUMBER(19) NOT NULL,
  ACCOUNT_FROM_ID NUMBER(19) NOT NULL,
  ACCOUNT_TO_ID NUMBER(19) NOT NULL,
  BILLING_AMOUNT NUMBER(38) NOT NULL,
  FOREIGN KEY (CLIENT_ID) REFERENCES CLIENTS (ID),
  FOREIGN KEY (ACCOUNT_FROM_ID) REFERENCES ACCOUNTS (ACCOUNT_NUMBER),
  FOREIGN KEY (ACCOUNT_TO_ID) REFERENCES ACCOUNTS (ACCOUNT_NUMBER),
  PRIMARY KEY (ID)
);

--changeset TestUsers_sql:6

CREATE TABLE PAYMENT_STATUS (
    ID NUMBER(19) GENERATED BY DEFAULT AS IDENTITY,
    PREVIOUS_PAYMENT_STATUS_ID NUMBER(19) NOT NULL,
    PAYMENT_REQUEST_ID NUMBER(19) NOT NULL,
    ACCOUNT_FROM_ID NUMBER(19) NOT NULL,
    ACCOUNT_TO_ID NUMBER(19) NOT NULL,
    AMOUNT NUMBER(38) NOT NULL,
    PAYMENT_STATE NUMBER(19) NOT NULL,
    TRANSACTION_ID NUMBER(19),
    DATE_CHANGE_STATUS DATE NOT NULL,
    PRIMARY KEY (ID)
);

--changeset TestUsers_sql:7

CREATE TABLE AUDIT_PAYMENT (
    ID NUMBER(19) GENERATED BY DEFAULT AS IDENTITY,
    PAYMENT_STATUS_ID NUMBER(19) NOT NULL,
    DATE_EVENT DATE NOT NULL,
    PAYMENT_ID NUMBER(19) NOT NULL,
    MESSAGE VARCHAR2(255),
    FOREIGN KEY (PAYMENT_STATUS_ID) REFERENCES PAYMENT_STATUS (ID),
    PRIMARY KEY (ID)
);